<html>
<head>
  <script type="module">
    import { store } from "/components/sidebar/chats/chats-store.js";
  </script>
</head>
<body>
  <div x-data class="flex flex-col flex-1 min-h-0">
    <template x-if="$store.chats">
      <div class="flex flex-col flex-1 min-h-0">
        <h3 class="sticky top-0 z-10 px-2 py-2 text-xs font-semibold text-gray-500 uppercase bg-white dark:bg-gray-800 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700/50">CHATS</h3>
        
        <!-- Chat list with hidden scrollbar via CSS class (added in global or standard utility) or custom style preserved locally if needed -->
        <ul class="flex-1 overflow-y-auto [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]" x-show="$store.chats.contexts.length > 0">
          <template x-for="context in $store.chats.contexts" :key="context.id">
            <li>
              <div class="relative flex items-center justify-between w-full p-2 my-1 text-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-700 transition-colors group"
                   :class="{'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300': context.id === $store.chats.selected}"
                   @click="$store.chats.selectChat(context.id)">
                <div class="flex items-center flex-1 gap-2 overflow-hidden">
                  <span class="w-2.5 h-2.5 rounded-full shrink-0"
                    :style="context.project?.color ? { backgroundColor: context.project.color } : { border: '1px solid currentColor' }"></span>
                  <span class="text-sm font-medium truncate" :title="context.name ? context.name : 'Chat #' + context.no"
                    x-text="context.name ? context.name : 'Chat #' + context.no"></span>
                </div>
                <button class="p-1 ml-2 text-gray-400 rounded opacity-0 group-hover:opacity-100 hover:text-red-500 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all" 
                        @click.stop="$store.chats.killChat(context.id)" title="Delete Chat">
                  <span class="material-symbols-outlined text-[16px]">close</span>
                </button>
              </div>
            </li>
          </template>
        </ul>
        <div class="flex items-center justify-center h-24 text-sm italic text-gray-500 dark:text-gray-400" x-show="$store.chats.contexts.length === 0">
          <p>No chats to list.</p>
        </div>
      </div>
    </template>
  </div>
</body>
</html>